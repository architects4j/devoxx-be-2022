
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tips and tricks: ultra-fast persistence and Java applications" name="description"/>
<meta content="Karina Varela and Ot√°vio Santana" name="author"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.0, mkdocs-material-8.2.15" name="generator"/>
<title>Delivering ultra-fast persistence with well-designed Java microservices - Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices</title>
<link href="../assets/stylesheets/main.c382b1dc.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cc9b2e1e.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="light-blue" data-md-color-primary="blue" data-md-color-scheme="slate" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#delivering-ultra-fast-persistence-with-well-designed-java-microservices">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices" class="md-header__button md-logo" data-md-component="logo" href=".." title="Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Delivering ultra-fast persistence with well-designed Java microservices
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/architects4j/devoxx-be-2022" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Devoxx Belgium 2022: Ultra-fast persistence with well-designed Java microservices
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/architects4j/devoxx-be-2022" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        About this workshop
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../00_environment/">
        Preparing your environment
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Delivering ultra-fast persistence with well-designed Java microservices
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Delivering ultra-fast persistence with well-designed Java microservices
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
    Introduction
  </a>
<nav aria-label="Introduction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-you-will-learn">
    What you will learn
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-requisites">
    Pre requisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hands-on-practice">
    Hands-on practice
  </a>
<nav aria-label="Hands-on practice" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started-with-microprofile">
    Getting started with MicroProfile
  </a>
<nav aria-label="Getting started with MicroProfile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#explore-the-project">
    Explore the project
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#package-and-run">
    Package and run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#going-further">
    Going further
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microstream-using-ultra-fast-persistence">
    MicroStream: using ultra-fast persistence
  </a>
<nav aria-label="MicroStream: using ultra-fast persistence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#add-microstream-to-the-project">
    Add MicroStream to the project
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-mapping-and-storage-configuration">
    Data mapping and storage configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-manipulation">
    Data manipulation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods-that-changes-persisted-data">
    Methods that changes persisted data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing-the-service">
    Testing the service
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02_nosql/">
        NoSQL persistence on Java services
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
          More
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="More" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          More
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../more/architects4j/">
        Architects4J
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../more/learn_more/">
        Learn more
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
    Introduction
  </a>
<nav aria-label="Introduction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-you-will-learn">
    What you will learn
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-requisites">
    Pre requisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hands-on-practice">
    Hands-on practice
  </a>
<nav aria-label="Hands-on practice" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started-with-microprofile">
    Getting started with MicroProfile
  </a>
<nav aria-label="Getting started with MicroProfile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#explore-the-project">
    Explore the project
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#package-and-run">
    Package and run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#going-further">
    Going further
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microstream-using-ultra-fast-persistence">
    MicroStream: using ultra-fast persistence
  </a>
<nav aria-label="MicroStream: using ultra-fast persistence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#add-microstream-to-the-project">
    Add MicroStream to the project
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-mapping-and-storage-configuration">
    Data mapping and storage configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-manipulation">
    Data manipulation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods-that-changes-persisted-data">
    Methods that changes persisted data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing-the-service">
    Testing the service
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="delivering-ultra-fast-persistence-with-well-designed-java-microservices"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.</span> Delivering ultra-fast persistence with well-designed Java microservices</h1>
<h2 id="introduction"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.1</span> Introduction</h2>
<h3 id="what-you-will-learn"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.1.1</span> What you will learn</h3>
<p>Here are the key learnings you will get with this hands-on exercise:</p>
<ul>
<li>
<p>Learn how Microprofile empowers Java developers to quickly build and deliver microservices. </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The exercises are built on Helidon as the runtime, although other MicroProfile runtimes can be used to implement the same examples. E.g. WildFly, Open Liberty, Payara.</p>
</div>
</li>
<li>
<p>Explore the basic project structure of a MicroProfile-based Java microservice;</p>
</li>
<li>Understand how architectural best practices allows the implementation decoupled code - domain logic and technical details are not tightened together;</li>
<li>Learn how to add in-memory Java-native persistence;</li>
<li>Know the capabilities that results from usage of specifications such as MicroProfile Config, CDI, JAX-RS and more;</li>
<li>Experience the benefits of using a Java native persistence solution, such as easy data model mapping and manipulation;</li>
</ul>
<h2 id="pre-requisites"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.2</span> Pre requisites</h2>
<p>To be able to go through this guided exercise, you will need to have the following components in your dev environment:</p>
<ul>
<li>Have finished the steps described in <a href="../00_environment/">Preparing your environment</a>, especially the section <em><a href="../00_environment/#prepare-your-working-directory">Prepare-your-working-directory</a></em>.</li>
</ul>
<h2 id="hands-on-practice"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3</span> Hands-on practice</h2>
<h3 id="getting-started-with-microprofile"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.1</span> Getting started with MicroProfile</h3>
<h4 id="explore-the-project"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.1.1</span> Explore the project</h4>
<p>The projects have the following characteristics:</p>
<table>
<thead>
<tr>
<th>Info</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>MicroProfile Version</td>
<td>3.3</td>
</tr>
<tr>
<td>Build Tool</td>
<td>Maven</td>
</tr>
<tr>
<td>MicroProfile Runtime</td>
<td>Helidon</td>
</tr>
</tbody>
</table>
<p>The project's structures are similar to:
   <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>.
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>‚îú‚îÄ‚îÄ pom.xml
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>‚îú‚îÄ‚îÄ readme.md
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>‚îî‚îÄ‚îÄ src
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>‚îî‚îÄ‚îÄ main
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>‚îú‚îÄ‚îÄ java
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>‚îÇ¬†¬† ‚îî‚îÄ‚îÄ org
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ a4j
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>‚îÇ¬†¬†¬†     ‚îî‚îÄ‚îÄ ...<span class="o">(</span>packages and classes<span class="o">)</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>‚îÇ¬†¬†         ‚îî‚îÄ‚îÄ resources
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>‚îÇ¬†¬†             ‚îî‚îÄ‚îÄ META-INF
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>‚îÇ¬†¬†                 ‚îú‚îÄ‚îÄ beans.xml
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a>‚îÇ¬†¬†                 ‚îî‚îÄ‚îÄ microprofile-config.properties
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>‚îî‚îÄ‚îÄ pom.xml
</code></pre></div></p>
<h4 id="package-and-run"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.1.2</span> Package and run</h4>
<ol>
<li>
<p>Open the terminal and access the project's folder: <code>devoxx-be-2022/workshop-foundation/microprofile/</code> </p>
</li>
<li>
<p>Run the following maven command. Maven will download the dependencies described in the project's <code>pom.xml</code> file. It will also create an executable jar we can use to access our application:<code>team.jar</code>.
   <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>mvn clean package
</code></pre></div></p>
</li>
<li>
<p>Now, let's start the microservice. In the terminal, run the following command:
   <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>java -jar target/team.jar
</code></pre></div></p>
</li>
<li>
<p>If everything goes well, you should see an output similar to:
   <code>bash
2022.10.11 02:34:00 INFO io.helidon.microprofile.server.ServerCdiExtension !thread!: Server started on http://localhost:8080 (and all other host addresses) in 2277 milliseconds (since JVM startup).
2022.10.11 02:34:00 INFO io.helidon.common.HelidonFeatures !thread!: Helidon MP 2.5.4 features:[CDI, Config, Fault Tolerance, Health, JAX-RS, Metrics, Open API, REST Client, Security, Server, Tracing]</code></p>
</li>
<li>
<p>In your browser, access the page <a href="http://localhost:8080/data/hello">http://localhost:8080/data/hello</a></p>
<div class="admonition question">
<p class="admonition-title">What are the classes that are responding to this request?</p>
</div>
</li>
<li>
<p>Now change the message that is displayed in this page to <strong>"Hello Devoxx Belgium!!!"</strong> .</p>
<details class="tip">
<summary>Tip</summary>
<p>In the class <code>org.a4j.workshop.HelloController</code>, you'll find a GET endpoint that prints the message you saw in your browser. If you update it, package and run the application you should see 
the changes reflected on the page. </p>
<p>When using helidon CLI and the Dev Loop, you should be able to visualize the change without the extra effort of manually re-packaging and running the service. </p>
</details>
</li>
<li>
<p>Package your application, start it again, and check the changes on the page. </p>
<details class="tip">
<summary>Tip</summary>
<p>Maven helps you packaging the application, and you can use the JDK installed locally to execute the generated file:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>mvn clean package
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>java -jar target/team.jar
</code></pre></div></p>
</details>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Congratulations</p>
<p>You've successfully created, packaged, changed and accessed an application based on the MicroProfile specification and that runs with the Helidon runtime!</p>
</div>
<h4 id="going-further"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.1.3</span> Going further</h4>
<p>There are several cool capabilities - such as native compilation and the Helidon dev loop - that you can further explore. To know more about these topics, refer to the <a href="../more/learn_more/">Learn More</a> page.</p>
<h3 id="microstream-using-ultra-fast-persistence"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.2</span> MicroStream: using ultra-fast persistence</h3>
<p>The project contains a data model and the respective classes required to manipulate these data:
* Data model: composed of the <code>Player</code>, <code>Position</code> and <code>Team</code> classes. 
* Service classes: the layer that holds business rules. The <code>TeamService</code> is part of it.
* Endpoints: the REST API is exposed through the resource class, in this case, <code>TeamResource</code>.</p>
<p>Feel free to explore these classes before moving forward.</p>
<h4 id="add-microstream-to-the-project"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.2.1</span> Add MicroStream to the project</h4>
<ol>
<li>
<p>To add MicroStream as the persistence solution of this microservice, we must add it as a maven dependency, so it gets included as a library when this project is build. Open the <code>pom.xml</code> and 
   add the following dependency:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>        <span class="nt">&lt;dependency&gt;</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>            <span class="nt">&lt;groupId&gt;</span>one.microstream<span class="nt">&lt;/groupId&gt;</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>            <span class="nt">&lt;artifactId&gt;</span>microstream-integrations-cdi<span class="nt">&lt;/artifactId&gt;</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>            <span class="nt">&lt;version&gt;</span>07.00.00-MS-GA<span class="nt">&lt;/version&gt;</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>        <span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></p>
</li>
<li>
<p>Next, we'll add Microstream's configuration. It relies on MicroProfile Config and has a very flexible and easy setup. Open <code>src/main/resources/META-INF/microprofile-config.properties</code>:
    <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="na">one.microstream.storage.directory</span><span class="o">=</span><span class="s">target/data</span><span class="w"></span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="na">one.microstream.channel.count</span><span class="o">=</span><span class="s">4 </span><span class="w"></span>
</code></pre></div></p>
<details class="tip">
<summary>Tip</summary>
<p>The property <code>one.microstream.storage.directory</code> indicates the folder where any data will be persisted. Filesystem is the default persistent storage target, although, it is not recommended
for production. To learn about other storage targets check out the <a href="https://docs.microstream.one/manual/storage/storage-targets/index.html">MicroStream documentation</a></p>
</details>
</li>
</ol>
<h4 id="data-mapping-and-storage-configuration"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.2.2</span> Data mapping and storage configuration</h4>
<ol>
<li>
<p><strong>Entity configurations</strong>:</p>
<p>Open the <code>Player</code> class. In the JPA world, this would be considered an entity bean and would be mapped with @Entity`. With MicroStream, there is no need to annotate classes and map them to 
  an existing database. </p>
<p>If we were using JPA, we would also have to set the <code>@Id</code> and <code>@Column</code> in the attributes of the class. </p>
<p><em>Good news</em>: nothing needs to be changed on the data model! </p>
</li>
<li>
<p><strong>Root and Storage:</strong> manipulating data gets very straightforward with MicroStream. The objects are serialized and saved in a graph structure, which means you don't have to worry with all the 
   complex relations between classes. The key is to understand what is going to be your <code>root</code> node. </p>
<p>In our scenario, we have a team of players. In this case, we do not want to allow the user to manipulate players as an independent model, instead, every player is part of a team - in other 
   words, it belongs to an object graph in which the <code>root</code> is the team. </p>
<p>Once you identify what is going to be the <code>root</code> class in your scenario, you then know which class you should configure with the <code>@Storage</code> annotation. Once you add the root node as a 
   <code>@Storage</code>, CDI will take care of a lot of work under the covers. You won't have to deal with transaction managers, persistence context and so on. As of now, let's configure the <code>Team</code> class as 
   our <code>root</code>: </p>
<p>4.1. Open the <code>org.a4j.workshop.Team</code> class, and annotate it with <code>@Storage</code> :</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nd">@Storage</span><span class="w"></span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Team</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</code></pre></div>
</li>
</ol>
<p>Next, you'll work on the methods that manipulates the data inside our service in-memory persistence storage.</p>
<h4 id="data-manipulation"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.2.3</span> Data manipulation</h4>
<p>---- wip refer to the comments in the code </p>
<h4 id="methods-that-changes-persisted-data"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.2.4</span> Methods that changes persisted data</h4>
<p>--- wip: @store in class teamservice</p>
<h3 id="testing-the-service"><span class="enumerate-headings-plugin enumerate-heading-plugin">2.3.3</span> Testing the service</h3>
<ul>
<li>By default it will run on port 8081, as configured in the <code>microprofile-config.properties</code>.</li>
<li>
<p>Check the service implementation with the following request examples:
----- wip: atualizar os requests</p>
<ul>
<li><strong>Insert</strong> a new product
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>
</code></pre></div></li>
<li><strong>List</strong> all products
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>
</code></pre></div></li>
<li><strong>Search</strong> a product by ID (name)
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>
</code></pre></div></li>
<li><strong>Update</strong> a product using its ID (name)
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>
</code></pre></div></li>
<li><strong>Delete</strong> a product by ID (name)
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>
</code></pre></div></li>
</ul>
</li>
<li>
<p>If you can successfully execute the above items, it means you acomplished this section's goals!</p>
</li>
</ul>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>You've finished your task! You have easily modified an existing project by taking advantadge of a well-defined persistence layer. You have used MicroStream to allow this service to persist its 
data using an ultra-fast in-memory solution. Well done!</p>
</div>
<hr/>
<div class="md-source-file">
<small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-10-11</span>
</small>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Preparing your environment" class="md-footer__link md-footer__link--prev" href="../00_environment/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Preparing your environment
            </div>
</div>
</a>
<a aria-label="Next: NoSQL persistence on Java services" class="md-footer__link md-footer__link--next" href="../02_nosql/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              NoSQL persistence on Java services
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Developed with ü§ç ¬† by Architects4j
    </div>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.instant", "navigation.tracking", "navigation.prune", "toc.follow", "navigation.top"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.a6c66575.min.js"></script>
</body>
</html>